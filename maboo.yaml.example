# Maboo - Embedded PHP Application Server Configuration
# Copy this file to maboo.yaml and adjust as needed

server:
  address: "0.0.0.0:8080"
  tls:
    auto: false        # Set true for auto self-signed cert (dev only)
    cert: ""           # Path to TLS certificate file
    key: ""            # Path to TLS private key file
  http3: false         # Enable HTTP/3 (requires TLS)

php:
  version: "auto"      # auto, 7.4, 8.0, 8.1, 8.2, 8.3, 8.4
  mode: "worker"       # worker (fast, persistent) or request (compatible, fresh)
  ini:
    memory_limit: "256M"
    max_execution_time: "30"

pool:
  min_workers: 4         # Minimum workers to keep alive
  max_workers: 32        # Maximum workers (auto-scale)
  max_jobs: 10000        # Max requests per worker before restart
  max_memory: "128M"     # Max memory per worker before restart
  idle_timeout: "60s"    # Kill idle workers after this duration
  allocate_timeout: "30s" # Timeout when allocating a worker
  request_timeout: "30s"  # Max time to handle single request

app:
  root: "."             # Document root
  entry: "auto"         # auto-detect, or explicit like "public/index.php"
  env:
    APP_ENV: "production"

# Static file serving
static:
  root: "public"        # Document root for static files
  cache_control: "public, max-age=3600"

logging:
  level: "info"         # debug, info, warn, error
  format: "json"        # json, text
  output: "stdout"      # stdout, stderr, or file path

# Prometheus metrics endpoint
metrics:
  enabled: true
  path: "/metrics"

# File watcher for development (auto-reload workers on PHP changes)
watch:
  enabled: false
  dirs:
    - "."
  interval: "2s"
